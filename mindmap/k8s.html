<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>

</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@6.6.0"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.2.3"></script><script>((e,t,r)=>{const{Markmap:n}=e();window.mm=n.create("svg#mindmap",null==t?void 0:t(),r)})(()=>window.markmap,t=>{return t=t||window.d3,{color:(n=t.scaleOrdinal(t.schemeCategory10),t=>n(t.p.i))};var n},{"t":"list_item","d":2,"p":{"lines":[0,1]},"v":"Kubernetes","c":[{"t":"list_item","d":4,"p":{"lines":[1,2]},"v":"基本理念","c":[{"t":"list_item","d":6,"p":{"lines":[2,3]},"v":"自动化部署，缩扩容和管理容器应用"},{"t":"list_item","d":6,"p":{"lines":[3,4]},"v":"预期状态管理(Desired State Management)","c":[{"t":"list_item","d":8,"p":{"lines":[4,5]},"v":"Kubernetes API 对象（声明预期状态）"},{"t":"list_item","d":8,"p":{"lines":[5,6]},"v":"Kubernetes Control Plane（确保集群当前状态匹配预期状态）","c":[{"t":"list_item","d":10,"p":{"lines":[6,7]},"v":"Kubernetes Master","c":[{"t":"list_item","d":12,"p":{"lines":[7,8]},"v":"kube-apiserver（API Server）","c":[{"t":"list_item","d":14,"p":{"lines":[8,9]},"v":"对外提供各种对象的CRUD REST接口"},{"t":"list_item","d":14,"p":{"lines":[9,10]},"v":"对外提供Watch机制，通知对象变化"},{"t":"list_item","d":14,"p":{"lines":[10,11]},"v":"将对象存储到Etcd中"}]},{"t":"list_item","d":12,"p":{"lines":[11,12]},"v":"kube-controller-manager（守护进程）","c":[{"t":"list_item","d":14,"p":{"lines":[12,13]},"v":"功能：通过apiserver监视集群的状态，并做出相应更改，以使得集群的当前状态向预期状态靠拢"},{"t":"list_item","d":14,"p":{"lines":[13,14]},"v":"controllers","c":[{"t":"list_item","d":16,"p":{"lines":[14,15]},"v":"replication controller"},{"t":"list_item","d":16,"p":{"lines":[15,16]},"v":"endpoints controller"},{"t":"list_item","d":16,"p":{"lines":[16,17]},"v":"namespace controller"},{"t":"list_item","d":16,"p":{"lines":[17,18]},"v":"serviceaccounts controller"},{"t":"list_item","d":16,"p":{"lines":[18,19]},"v":"......"}]}]},{"t":"list_item","d":12,"p":{"lines":[19,20]},"v":"kube-scheduler（调度器）","c":[{"t":"list_item","d":14,"p":{"lines":[20,21]},"v":"功能：将Pod调度到合适的工作节点上运行"},{"t":"list_item","d":14,"p":{"lines":[21,22]},"v":"调度的考虑因素","c":[{"t":"list_item","d":16,"p":{"lines":[22,23]},"v":"资源需求"},{"t":"list_item","d":16,"p":{"lines":[23,24]},"v":"服务治理要求"},{"t":"list_item","d":16,"p":{"lines":[24,25]},"v":"硬件/软件/策略限制"},{"t":"list_item","d":16,"p":{"lines":[25,26]},"v":"亲和以及反亲和要求"},{"t":"list_item","d":16,"p":{"lines":[26,27]},"v":"数据局域性"},{"t":"list_item","d":16,"p":{"lines":[27,28]},"v":"负载间的干扰"},{"t":"list_item","d":16,"p":{"lines":[28,29]},"v":"......"}]}]}]},{"t":"list_item","d":10,"p":{"lines":[29,30]},"v":"Work Node","c":[{"t":"list_item","d":12,"p":{"lines":[30,31]},"v":"Kubelet（节点代理）","c":[{"t":"list_item","d":14,"p":{"lines":[31,32]},"v":"接受通过各种机制（主要是通过apiserver）提供的一组PodSpec"},{"t":"list_item","d":14,"p":{"lines":[32,33]},"v":"确保PodSpec中描述的容器处于运行状态且运行状况良好"}]},{"t":"list_item","d":12,"p":{"lines":[33,34]},"v":"Kube-proxy（节点网络代理）","c":[{"t":"list_item","d":14,"p":{"lines":[34,35]},"v":"在节点上提供Kubernetes API中定义Service"},{"t":"list_item","d":14,"p":{"lines":[35,36]},"v":"设置Service对应的IPtables规则"},{"t":"list_item","d":14,"p":{"lines":[36,37]},"v":"进行流量转发（userspace模式）"}]}]}]}]}]},{"t":"list_item","d":4,"p":{"lines":[37,38]},"v":"部署模式","c":[{"t":"list_item","d":6,"p":{"lines":[38,39]},"v":"Single node"},{"t":"list_item","d":6,"p":{"lines":[39,40]},"v":"Single head node，multiple workers","c":[{"t":"list_item","d":8,"p":{"lines":[40,41]},"v":"API Server，Scheduler，and Controller Manager run on a single node"}]},{"t":"list_item","d":6,"p":{"lines":[41,42]},"v":"Single etcd，HA heade nodes，multiple workers","c":[{"t":"list_item","d":8,"p":{"lines":[42,43]},"v":"Multiple API Server instances fronted by a load balancer"},{"t":"list_item","d":8,"p":{"lines":[43,44]},"v":"Multiple Scheduler and Controller Manager instances with leader election"},{"t":"list_item","d":8,"p":{"lines":[44,45]},"v":"Single etcd node"}]},{"t":"list_item","d":6,"p":{"lines":[45,46]},"v":"HA etcd，HA head nodes，multiple workers","c":[{"t":"list_item","d":8,"p":{"lines":[46,47]},"v":"Multiple API Server instances fronted by a load balancer"},{"t":"list_item","d":8,"p":{"lines":[47,48]},"v":"Multiple Scheduler and Controller Manager instances with leader election"},{"t":"list_item","d":8,"p":{"lines":[48,49]},"v":"Etcd cluster run on nodes seperate from the Kubernetes head nodes"}]},{"t":"list_item","d":6,"p":{"lines":[49,50]},"v":"Kubernetes Federation"}]},{"t":"list_item","d":4,"p":{"lines":[50,51]},"v":"Workload","c":[{"t":"list_item","d":6,"p":{"lines":[51,52]},"v":"Pod","c":[{"t":"list_item","d":8,"p":{"lines":[52,53]},"v":"Smalleset deployable computing unit"},{"t":"list_item","d":8,"p":{"lines":[53,54]},"v":"Consist of one or more containers"},{"t":"list_item","d":8,"p":{"lines":[54,55]},"v":"All containers in a pod share <a href=\"https://kubernetes.io/docs/concepts/storage/volumes/\">storage</a>, <a href=\"https://zhaohuabing.com/post/2020-03-12-linux-network-virtualization/#network-namespace\">network namespacem</a> and <a href=\"https://man7.org/linux/man-pages/man7/cgroups.7.html\">cgroup</a>"}]},{"t":"list_item","d":6,"p":{"lines":[55,56]},"v":"Workload resources(Controllers)","c":[{"t":"list_item","d":8,"p":{"lines":[56,57]},"v":"Deployment &amp; RelicaSet","c":[{"t":"list_item","d":10,"p":{"lines":[57,58]},"v":"Deployment is used to deploy stateless appliations."},{"t":"list_item","d":10,"p":{"lines":[58,59]},"v":"ReplicaSet ensured a specified numbers of pod replicas are running at a given time."},{"t":"list_item","d":10,"p":{"lines":[59,60]},"v":"Deployment is used to rollout/update/rollback ReplicaSet."},{"t":"list_item","d":10,"p":{"lines":[60,61]},"v":"ReplicaSet is not supposed to be used directly, it should be managed by Deployments."}]},{"t":"list_item","d":8,"p":{"lines":[61,62]},"v":"StatefulSet","c":[{"t":"list_item","d":10,"p":{"lines":[62,63]},"v":"StatefulSet is used to deploy stateful applications."},{"t":"list_item","d":10,"p":{"lines":[63,64]},"v":"SetatefSet require a Headless Service to provide network identity for the pods."}]},{"t":"list_item","d":8,"p":{"lines":[64,65]},"v":"DaemonSet","c":[{"t":"list_item","d":10,"p":{"lines":[65,66]},"v":"DaemonSet ensures that all(or some) Nodes run a copy of a Pod."},{"t":"list_item","d":10,"p":{"lines":[66,67]},"v":"Use cases: cluster storage daemon, logs collection daemon, node monitoring daemon."}]},{"t":"list_item","d":8,"p":{"lines":[67,68]},"v":"Job &amp; CronJob","c":[{"t":"list_item","d":10,"p":{"lines":[68,69]},"v":"Job runs pods until a specified number of them have been succcessfully executed."},{"t":"list_item","d":10,"p":{"lines":[69,70]},"v":"CronJob runs a job periodically on a given schedule."}]}]}]},{"t":"list_item","d":4,"p":{"lines":[70,71]},"v":"商业模式","c":[{"t":"list_item","d":6,"p":{"lines":[71,72]},"v":"云服务用户：避免使用单一云提供商导致的厂商锁定，避免技术和成本风险"},{"t":"list_item","d":6,"p":{"lines":[72,73]},"v":"云服务厂商：使用Kubernetes来打破AWS的先入垄断地位，抢夺市场份额"}]},{"t":"list_item","d":4,"p":{"lines":[73,74]},"v":"Network","c":[{"t":"list_item","d":6,"p":{"lines":[74,75]},"v":"Linux Network Virtualization","c":[{"t":"list_item","d":8,"p":{"lines":[75,76]},"v":"<a href=\"https://zhaohuabing.com/post/2020-02-24-linux-taptun/\">Linux tun/tap</a>"}]},{"t":"list_item","d":6,"p":{"lines":[76,77]},"v":"<a href=\"https://zhaohuabing.com/post/2020-03-12-linux-network-virtualization/#network-namespace\">Network Namespace</a>"},{"t":"list_item","d":6,"p":{"lines":[77,78]},"v":"<a href=\"https://zhaohuabing.com/post/2020-03-12-linux-network-virtualization/#veth\">Veth Pair</a>"},{"t":"list_item","d":6,"p":{"lines":[78,79]},"v":"<a href=\"https://zhaohuabing.com/post/2020-03-12-linux-network-virtualization/#bridge\">Linux bridge</a>"},{"t":"list_item","d":6,"p":{"lines":[79,80]},"v":"Vlan"},{"t":"list_item","d":6,"p":{"lines":[80,81]},"v":"Vxlan","c":[{"t":"list_item","d":8,"p":{"lines":[81,82]},"v":"<a href=\"https://cizixs.com/2017/09/25/vxlan-protocol-introduction/\">Vxlan原理</a>"},{"t":"list_item","d":8,"p":{"lines":[82,83]},"v":"<a href=\"https://cizixs.com/2017/09/28/linux-vxlan/\">Linux 上实现 vxlan 网络</a>"}]},{"t":"list_item","d":6,"p":{"lines":[83,84]},"v":"Routing Protocol","c":[{"t":"list_item","d":8,"p":{"lines":[84,85]},"v":"Distance Vector Protocol","c":[{"t":"list_item","d":10,"p":{"lines":[85,86]},"v":"BGP"}]},{"t":"list_item","d":8,"p":{"lines":[86,87]},"v":"Link-State Protocol","c":[{"t":"list_item","d":10,"p":{"lines":[87,88]},"v":"OSPF"}]}]},{"t":"list_item","d":6,"p":{"lines":[88,89]},"v":"K8s Network","c":[{"t":"list_item","d":8,"p":{"lines":[89,94]},"v":"Service<br>\n- <a href=\"https://zhaohuabing.com/post/2019-03-29-how-to-choose-ingress-for-service-mesh/#cluster-ip\">Cluster IP</a><br>\n- <a href=\"https://kubernetes.io/zh/docs/concepts/services-networking/service/#headless-services\">Headless</a><br>\n- <a href=\"https://zhaohuabing.com/post/2019-03-29-how-to-choose-ingress-for-service-mesh/#nodeport\">NodePort</a><br>\n- <a href=\"https://zhaohuabing.com/post/2019-03-29-how-to-choose-ingress-for-service-mesh/#loadbalancer\">LoadBalancer</a>","c":[{"t":"list_item","d":10,"p":{"lines":[94,95]},"v":"Ingress","c":[{"t":"list_item","d":12,"p":{"lines":[95,96]},"v":"<a href=\"https://zhaohuabing.com/post/2019-03-29-how-to-choose-ingress-for-service-mesh/#k8s-ingress\">K8s Ingress</a>"},{"t":"list_item","d":12,"p":{"lines":[96,97]},"v":"<a href=\"https://zhaohuabing.com/post/2019-03-29-how-to-choose-ingress-for-service-mesh/#istio-gateway\">Istio Ingress Gateway</a>"}]}]},{"t":"list_item","d":8,"p":{"lines":[97,98]},"v":"腾讯云","c":[{"t":"list_item","d":10,"p":{"lines":[98,99]},"v":"<a href=\"https://zhaohuabing.com/post/2021-03-24-tke-network-mode/#global-router-%E6%A8%A1%E5%BC%8F\">Global Router</a>"},{"t":"list_item","d":10,"p":{"lines":[99,100]},"v":"<a href=\"https://zhaohuabing.com/post/2021-03-24-tke-network-mode/#vpc-cni-%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%BC%8F\">VPC-CNI</a>"}]},{"t":"list_item","d":8,"p":{"lines":[100,101]},"v":"<a href=\"https://zhaohuabing.com/post/2019-03-29-how-to-choose-ingress-for-service-mesh/#api-gateway--sidecar-proxy\">API Gateway+Service Mesh</a>"},{"t":"list_item","d":8,"p":{"lines":[101,102]},"v":"Kubernetes CNI插件","c":[{"t":"list_item","d":10,"p":{"lines":[102,103]},"v":"<a href=\"https://www.lijiaocn.com/%E9%A1%B9%E7%9B%AE/2017/04/11/calico-usage.html\">Calico</a>"}]}]}]},{"t":"list_item","d":4,"p":{"lines":[103,104]},"v":"Security","c":[{"t":"list_item","d":6,"p":{"lines":[104,105]},"v":"Background Knowledge","c":[{"t":"list_item","d":8,"p":{"lines":[105,106]},"v":"<a href=\"https://zhaohuabing.com/post/2020-03-19-pki/\">Certificate and PKI</a>"},{"t":"list_item","d":8,"p":{"lines":[106,107]},"v":"<a href=\"https://zhaohuabing.com/post/2020-05-19-k8s-certificate/\">Kubernetes 中使用到的证书</a>"}]},{"t":"list_item","d":6,"p":{"lines":[107,108]},"v":"User Type","c":[{"t":"list_item","d":8,"p":{"lines":[108,109]},"v":"Service Account","c":[{"t":"list_item","d":10,"p":{"lines":[109,110]},"v":"Managed by Kubernetes"},{"t":"list_item","d":10,"p":{"lines":[110,111]},"v":"Represent workloads in the cluster"},{"t":"list_item","d":10,"p":{"lines":[111,112]},"v":"Bound to a specific namespace"}]},{"t":"list_item","d":8,"p":{"lines":[112,113]},"v":"<a href=\"https://kubernetes.io/docs/reference/access-authn-authz/certificate-signing-requests/#normal-user\">Normal User</a>","c":[{"t":"list_item","d":10,"p":{"lines":[113,114]},"v":"Managed out side of Kubernetes"},{"t":"list_item","d":10,"p":{"lines":[114,115]},"v":"Authenticated with a valid certicated signed by the cluster's CA","c":[{"t":"list_item","d":12,"p":{"lines":[115,116]},"v":"User name: Certificate subject <a href=\"https://docs.oracle.com/cd/E24191_01/common/tutorials/authz_cert_attributes.html\">Common Name</a> field"},{"t":"list_item","d":12,"p":{"lines":[116,117]},"v":"Group: Certificate subject <a href=\"https://docs.oracle.com/cd/E24191_01/common/tutorials/authz_cert_attributes.html\">Organization</a> field"}]}]}]},{"t":"list_item","d":6,"p":{"lines":[117,118]},"v":"Authentication","c":[{"t":"list_item","d":8,"p":{"lines":[118,119]},"v":"Service account tokens for service accounts"},{"t":"list_item","d":8,"p":{"lines":[119,120]},"v":"Client certifications for normal users"},{"t":"list_item","d":8,"p":{"lines":[120,121]},"v":"<a href=\"https://zhaohuabing.com/post/2020-05-19-k8s-certificate/#service-account--%E8%AF%81%E4%B9%A6\">Certifications for control plane components communication</a>"},{"t":"list_item","d":8,"p":{"lines":[121,122]},"v":"<a href=\"https://zhaohuabing.com/post/2020-05-19-k8s-certificate/#%E4%BD%BF%E7%94%A8-tls-bootstrapping-%E7%AE%80%E5%8C%96-kubelet-%E8%AF%81%E4%B9%A6%E5%88%B6%E4%BD%9C\">Bootstrap Token</a> for clusters and nodes bootstrapping"}]},{"t":"list_item","d":6,"p":{"lines":[122,123]},"v":"Authorization","c":[{"t":"list_item","d":8,"p":{"lines":[123,124]},"v":"<a href=\"https://kubernetes.io/docs/reference/access-authn-authz/rbac/\">RBAC</a>","c":[{"t":"list_item","d":10,"p":{"lines":[124,125]},"v":"Namespace Scope","c":[{"t":"list_item","d":12,"p":{"lines":[125,126]},"v":"Role"},{"t":"list_item","d":12,"p":{"lines":[126,127]},"v":"RoleBinding (Associate users retrived from authentication process to Roles)"}]},{"t":"list_item","d":10,"p":{"lines":[127,128]},"v":"Cluster Scope","c":[{"t":"list_item","d":12,"p":{"lines":[128,129]},"v":"ClusterRole"},{"t":"list_item","d":12,"p":{"lines":[129,130]},"v":"CluseterRoleBinding (Associate users retrived from authentication process to ClusteRoles)"}]}]}]}]}]})</script>
</body>
</html>
