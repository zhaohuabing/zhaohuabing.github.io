<!DOCTYPE html>
<html lang="en-us">
<head><head>
    <meta name="google-site-verification" content="9vIieCe-Qpd78QOmBl63rGtIVbhY6sYyuxX3j8XWBA4" />
    <meta name="baidu-site-verification" content="LRrmH41lz7" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="description" content="赵化冰，程序员, 开源爱好者，生活探险家 | 这里是 赵化冰 的博客，与你一起发现更大的世界。">
    
    <meta name="keyword"  content="赵化冰, zhaohuabing, Zhaohuabing, , 赵化冰的网络日志, 赵化冰的博客, Zhaohuabing Blog, 博客, 个人网站, 互联网, Web, 云原生, PaaS, Istio, Kubernetes, 微服务, Microservice">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>Manage ONAP Microservices with Istio Service Mesh-赵化冰的博客 | Zhaohuabing Blog</title>

    <link rel="canonical" href="/post/2018-08-01-manage-onap-with-istio/">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>
	
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="/css/syntax.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">

    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    
    
    <script src="/js/jquery.min.js"></script>
    
    
    <script src="/js/bootstrap.min.js"></script>
    
    
    <script src="/js/hux-blog.min.js"></script>
</head>
</head>

<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Huabing Blog</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    <li>
                        <a href="/categories/life">Life</a>
                    </li>
                    
                    <li>
                        <a href="/categories/note">Note</a>
                    </li>
                    
                    <li>
                        <a href="/categories/tech">Tech</a>
                    </li>
                    
                    <li>
                        <a href="/categories/tips">Tips</a>
                    </li>
                    

                    
		            <li>
                        <a href="/search">SEARCH <img src="/img/search.png" height="15" style="cursor: pointer;"></a>
		            </li>
                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header{
        background-image: url('https://img.zhaohuabing.com/in-post/2018-08-01-manage-onap-with-istio/backgroud.jpeg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                       
                       <a class="tag" href="/tags/istio" title="Istio">
                           Istio
                        </a>
                        
                       <a class="tag" href="/tags/onap" title="ONAP">
                           ONAP
                        </a>
                        
                       <a class="tag" href="/tags/service-mesh" title="Service Mesh">
                           Service Mesh
                        </a>
                        
                    </div>
                    <h1>Manage ONAP Microservices with Istio Service Mesh</h1>
                    <h2 class="subheading"></h2>
                    <span  class="meta">Posted by     &#34;赵化冰&#34; on Wednesday, August 1, 2018
                        
                        <span id="/post/2018-08-01-manage-onap-with-istio/" class="leancloud_visitors meta_data_item" data-flag-title="">
    <span class="post-meta-item-icon">
      <span class="octicon octicon-eye"></span> 
    </span>
    <i class="fa fa-eye"></i>
    <span class="old-visitors-count" style="display: none;"></span>
    <span class="leancloud-visitors-count"></span>
</span>



<script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>

<script>
	AV.initialize("Xu5MAnXL360Ms89vMVnWBjuq-gzGzoHsz", "efUYEefAc2eIPBRO59PRERQC");
</script>

<script type="text/javascript">
function showTime(Counter) {
    var query = new AV.Query(Counter);
    var entries = [];
    var $visitors = $(".leancloud_visitors");

    $visitors.each(function() {
        entries.push($(this).attr("id").trim());
    });

    query.containedIn('url', entries);
    query.find()
        .done(function(results) {
            var COUNT_CONTAINER_REF = '.leancloud-visitors-count';
            var OLD_COUNT_CONTAINER_REF = '.old-visitors-count';

            
            
            
            

            for (var i = 0; i < results.length; i++) {
                var item = results[i];
                var url = item.get('url');
                var time = item.get('time');
                var element = document.getElementById(url);

                $(element).find(COUNT_CONTAINER_REF).text(time);
            }
            for (var i = 0; i < entries.length; i++) {
                var url = entries[i];
                var element = document.getElementById(url);
                var countSpan = $(element).find(COUNT_CONTAINER_REF);
                if (countSpan.text() == '') {
                    var oldCountSpan = $(element).find(OLD_COUNT_CONTAINER_REF).text();
                    if(oldCountSpan!=''){
                        countSpan.text(0+parseInt(oldCountSpan));
                    }else{
                        countSpan.text(0);          
                    }
                }
            }
        })
        .fail(function(object, error) {
            console.log("Error: " + error.code + " " + error.message);
        });
}

function addCount(Counter) {
    var $visitors = $(".leancloud_visitors");
    var url = $visitors.attr('id').trim();
    var title = $visitors.attr('data-flag-title').trim();
    var query = new AV.Query(Counter);

    query.equalTo("url", url);
    query.find({
        success: function(results) {
            if (results.length > 0) {
                var counter = results[0];
                counter.fetchWhenSave(true);
                counter.increment("time");
                counter.save(null, {
                    success: function(counter) {
                        var $element = $(document.getElementById(url));
                        $element.find('.leancloud-visitors-count').text(counter.get('time'));
                    },
                    error: function(counter, error) {
                        console.log('Failed to save Visitor num, with error message: ' + error.message);
                    }
                });
            } else {
                var newcounter = new Counter();
                 
                var acl = new AV.ACL();
                acl.setPublicReadAccess(true);
                acl.setPublicWriteAccess(true);
                newcounter.setACL(acl);
                 
                newcounter.set("title", title);
                newcounter.set("url", url);
                var OLD_COUNT_CONTAINER_REF = '.old-visitors-count';
                var $element = $(document.getElementById(url));
                var oldCountSpan = $element.find(OLD_COUNT_CONTAINER_REF).text();
                if(oldCountSpan!=''){
                    newcounter.set("time", parseInt(oldCountSpan)+1);
                }else{
 	                    newcounter.set("time",  1);
                }
                newcounter.save(null, {
                    success: function(newcounter) {
                        var $element = $(document.getElementById(url));
                        $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
                    },
                    error: function(newcounter, error) {
                        console.log('Failed to create');
                    }
                });
            }
        },
        error: function(error) {
            console.log('Error:' + error.code + " " + error.message);
        }
    });
}
$(function() {
    var Counter = AV.Object.extend("Counter");
    
    
    if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
    } else {
        showTime(Counter);
    }
});
</script>

                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

        		
                        <header>
                        <h2>TOC</h2>
                        </header>
                        <nav id="TableOfContents">
<ul>
<li><a href="#installation">Installation</a>
<ul>
<li><a href="#kubernetes-master">Kubernetes Master</a></li>
<li><a href="#kubernetes-worker-node">Kubernetes worker Node</a></li>
<li><a href="#istio-control-plane">Istio Control Plane</a></li>
<li><a href="#sidecar-injection">Sidecar Injection</a></li>
</ul></li>
<li><a href="#explore-istio-features">Explore Istio Features</a>
<ul>
<li><a href="#distributed-tracing">Distributed Tracing</a></li>
<li><a href="#service-graph">Service Graph</a></li>
<li><a href="#metrics-visualization">Metrics Visualization</a></li>
</ul></li>
</ul>
</nav>
        		
        		

<p>In the previous post <a href="https://zhaohuabing.com/post/2018-06-22-onap-with-service-mesh/">How service mesh can help during the ONAP Microservice journey</a>, we have discussed why the community wants ONAP to evolve towards Microservice architecture and how service mesh approach could help during the journey. Now it’s time to dip our toe in the water, let’s try out Istio with ONAP by following the below steps.
<!-- more --></p>

<h1 id="installation">Installation</h1>

<p>First, download installation scripts from ONAP Gerrit:</p>

<pre><code>git clone https://gerrit.onap.org/r/msb/service-mesh
</code></pre>

<h2 id="kubernetes-master">Kubernetes Master</h2>

<p>We need Kubernetes 1.9 or newer to enable automatic sidecar injection, so we don’t have to modify every individual ONAP kubernetes yaml deployment files to add the sidecar container, which would be inconvenient.</p>

<p>Istio leverages the webhook feature of Kubernetes to automatically inject an Envoy sidecar to each Pod. Kubernetes API server will call the Istio sidecar injection webhook when it receives a request to create a Pod resource, the webhook adds an Envoy sidecar container to the Pod, then the modified Pod resource is stored into etcd.</p>

<p>Webhook and other needed features have already been configured in the install scripts to enable Istio sidecar injection.</p>

<p>Create the Kubernetes master by running this script:</p>

<pre><code>cd service-mesh/install/
./1_install_k8s_master.sh
</code></pre>

<p>This script will create a Kubernetes master node with Kubeadm and install calico network plugin. Some other needed tools such as Docker, Kubectl and Helm will be installed as well.</p>

<p>From the output of the script, you should see a command on how to join a node to the created Kubernetes cluster. Note that this is just an example, the token and cert-hash of your installation will be different, please copy &amp; paste the command to somewhere, we will need it later.</p>

<pre><code>You can now join any number of machines by running the following on each node
as root:
 
  kubeadm join 10.12.5.104:6443 --token 1x62yf.60ys5p2iw13tx2t8 --discovery-token-ca-cert-hash sha256:f06628c7cee002b262e69f3f9efadf47bdec125e19606ebff743a3e514a8383b
</code></pre>

<h2 id="kubernetes-worker-node">Kubernetes worker Node</h2>

<p>Log in the worker node machine, run this script to create a kubernetes worker node:</p>

<pre><code>./2_install_k8s_minion.sh
</code></pre>

<p>You can now join this machines by running “kubeadmin join” command as root:</p>

<pre><code>sudo kubeadm join 10.12.5.104:6443 --token 1x62yf.60ys5p2iw13tx2t8 --discovery-token-ca-cert-hash sha256:f06628c7cee002b262e69f3f9efadf47bdec125e19606ebff743a3e514a8383
Please note that this is just an example, please refer to the output of the “kubeamin init” when creating the k8s master for the exact command to use in your k8s cluster.
</code></pre>

<p>If you would like to get kubectl talk to your k8s master, you need to copy the administrator kubeconfig file from your master to your workstation like this:</p>

<pre><code>scp root@&lt;master ip&gt;:/etc/kubernetes/admin.conf .
kubectl --kubeconfig ./admin.conf get nodes
</code></pre>

<p>Or you can manually copy the content of this file to ~/.kube/conf if scp can’t be used due to security reason.</p>

<h2 id="istio-control-plane">Istio Control Plane</h2>

<p>Install Istio by running this script:</p>

<pre><code>./ 3_install_istio.sh
</code></pre>

<p>This script installs the followings Istio components:
Install Istioctl command line tool in the /usr/bin directory
Install Istio control plane components, including Pilot, Citadel, Mixer
Install addons including servicegraph, Promeheus, Grafana, jaeger
Confirm Istio was installed:</p>

<pre><code>kubectl get svc -n istio-system
NAME                       TYPE           CLUSTER-IP       EXTERNAL-IP   PORT(S)                                                               AGE
grafana                    NodePort       10.109.190.71    &lt;none&gt;        3000:30300/TCP                                                        20m
istio-citadel              ClusterIP      10.106.185.181   &lt;none&gt;        8060/TCP,9093/TCP                                                     20m
istio-egressgateway        ClusterIP      10.102.224.133   &lt;none&gt;        80/TCP,443/TCP                                                        20m
istio-ingressgateway       LoadBalancer   10.100.168.32    &lt;pending&gt;     80:31380/TCP,443:31390/TCP,31400:31400/TCP                            20m
istio-pilot                ClusterIP      10.101.64.153    &lt;none&gt;        15003/TCP,15005/TCP,15007/TCP,15010/TCP,15011/TCP,8080/TCP,9093/TCP   20m
istio-policy               ClusterIP      10.104.11.162    &lt;none&gt;        9091/TCP,15004/TCP,9093/TCP                                           20m
istio-sidecar-injector     ClusterIP      10.100.229.40    &lt;none&gt;        443/TCP                                                               20m
istio-statsd-prom-bridge   ClusterIP      10.107.27.91     &lt;none&gt;        9102/TCP,9125/UDP                                                     20m
istio-telemetry            ClusterIP      10.101.153.114   &lt;none&gt;        9091/TCP,15004/TCP,9093/TCP,42422/TCP                                 20m
prometheus                 ClusterIP      10.103.0.205     &lt;none&gt;        9090/TCP                                                              20m
servicegraph               NodePort       10.106.49.168    &lt;none&gt;        8088:30088/TCP                                                        20m
tracing                    LoadBalancer   10.100.158.236   &lt;pending&gt;     80:30188/TCP                                                          20m
zipkin                     NodePort       10.96.164.255    &lt;none&gt;        9411:30411/TCP       
</code></pre>

<h2 id="sidecar-injection">Sidecar Injection</h2>

<p>In the transition phase, the Istio sidecar injector policy is configured as “disabled” when installing Istio. So the sidecar injector will not inject the sidecar into pods by default. Add the <code>sidecar.istio.io/inject annotation</code> with value <code>true</code> to the pod template spec to enable injection.</p>

<p>Example:</p>

<pre><code>apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: {{ include &quot;common.fullname&quot; . }}
  namespace: {{ include &quot;common.namespace&quot; . }}
  labels:
    app: {{ include &quot;common.name&quot; . }}
    chart: {{ .Chart.Name }}-{{ .Chart.Version | replace &quot;+&quot; &quot;_&quot; }}
    release: {{ .Release.Name }}
    heritage: {{ .Release.Service }}
spec:
  replicas: {{ .Values.replicaCount }}
  selector:
    matchLabels:
      app: multicloud-vio
  template:
    metadata:
      labels:
        app: {{ include &quot;common.name&quot; . }}
        release: {{ .Release.Name }}
      name: {{ include &quot;common.name&quot; . }}
      annotations:
        sidecar.istio.io/inject: &quot;{{.Values.istioSidecar}}&quot;
</code></pre>

<p>Note: when all ONAP projects are ready for Istio integration, the Istio sidecar injector policy could be configured as “enabled”, then the annotation in the pod will not be necessary any more.</p>

<p>Enable Istio sidecar injection webhook.</p>

<pre><code>kubectl create namespace onap
kubectl label namespace onap istio-injection=enabled
</code></pre>

<p>Confirm that auto sidecar injection has been enabled on onap namespace.</p>

<pre><code>kubectl get namespace -L istio-injection
NAME           STATUS    AGE       ISTIO-INJECTION
default        Active    20m
istio-system   Active    10m
kube-public    Active    20m
kube-system    Active    20m
onap           Active    8s        enabled
</code></pre>

<p>Start a local helm repository server and add it to helm repository list:</p>

<pre><code>helm serve &amp;
helm repo add local http://127.0.0.1:8879
</code></pre>

<p>All the charts of ONAP components are in the OOM repository, let’s download and build the ONAP helm charts.</p>

<pre><code>git clone -b beijing http://gerrit.onap.org/r/oom
cd oom/kubernetes
make all
</code></pre>

<p>Confirm that ONAP charts have been successfully created.</p>

<pre><code>helm search onap
NAME                    CHART VERSION   APP VERSION     DESCRIPTION
local/onap              2.0.0           beijing         Open Network Automation Platform (ONAP)
local/aaf               2.0.0                           ONAP Application Authorization Framework
local/aai               2.0.0                           ONAP Active and Available Inventory
local/clamp             2.0.0                           ONAP Clamp
local/cli               2.0.0                           ONAP Command Line Interface
local/consul            2.0.0                           ONAP Consul Agent
local/dcaegen2          2.0.0                           ONAP DCAE Gen2
local/dmaap             2.0.0                           ONAP DMaaP components
local/esr               2.0.0                           ONAP External System Register
local/log               2.0.0                           ONAP Logging ElasticStack
local/msb               2.0.0                           ONAP MicroServices Bus
local/multicloud        2.0.0                           ONAP multicloud broker
local/nbi               2.0.0                           ONAP Northbound Interface
local/oof               2.0.0                           ONAP Optimization Framework
local/policy            2.0.0                           ONAP Policy Administration Point
local/portal            2.0.0                           ONAP Web Portal
local/postgres          2.0.0                           ONAP Postgres Server
local/robot             2.0.0                           A helm Chart for kubernetes-ONAP Robot
local/sdnc-prom         2.0.0                           ONAP SDNC Policy Driven Ownership Management
local/sniro-emulator    2.0.0                           ONAP Mock Sniro Emulator
local/so                2.0.0                           ONAP Service Orchestrator
local/uui               2.0.0                           ONAP uui
local/vfc               2.0.0                           ONAP Virtual Function Controller (VF-C)
local/vid               2.0.0                           ONAP Virtual Infrastructure Deployment
local/vnfsdk            2.0.0                           ONAP VNF SDK
</code></pre>

<p>Install local/onap chart. Local/onap chart will do initialization setup which is needed for onap components, such as creating service accounts.</p>

<pre><code>cd oom/kubernetes
helm install local/onap -n common --namespace onap -f onap/resources/environments/disable-allcharts.yaml
</code></pre>

<p>In Casablanca, MSB project is working with VF-C and MultiCloud as pilot projects, we would like to roll out it to the other ONAP projects after verifying the integration and Istio features.</p>

<pre><code>helm install local/msb -n msb --namespace
helm install local/vfc -n vfc --namespace onap
helm install local/multicloud -n multicloud --namespace onap
</code></pre>

<p>Note that you can also install other ONAP projects with helm install if they are needed. But Istio sidecar will not be injected to their Pods by default.</p>

<p>Confirm that ONAP microservices have been started:</p>

<pre><code>kubectl get all -n onap
NAME READY STATUS RESTARTS AGE
pod/msb-kube2msb-77ccb675dd-rhfn7 1/1 Running 0 3h
pod/msb-msb-consul-646987f5cf-qms5v 2/2 Running 0 3h
pod/msb-msb-discovery-7647f6476f-cl6xw 3/3 Running 0 3h
pod/msb-msb-eag-d678c65d6-fmfn6 3/3 Running 0 3h
pod/msb-msb-iag-647d5f998c-dc766 3/3 Running 0 3h
pod/multicloud-multicloud-5679bd9876-tzxzw 2/2 Running 0 1h
pod/multicloud-multicloud-ocata-774579596-f7smf 3/3 Running 0 1h
pod/multicloud-multicloud-vio-8c7dbc8d5-lfcw6 3/3 Running 0 1h
pod/multicloud-multicloud-windriver-85b595675d-5vx45 3/3 Running 0 1h
pod/vfc-vfc-catalog-79764dfd8f-rkx6f 2/2 Running 1 2d
pod/vfc-vfc-ems-driver-75bc68b946-6r6r6 1/1 Running 1 2d
pod/vfc-vfc-generic-vnfm-driver-69bf778bfd-pscjn 2/2 Running 0 2d
pod/vfc-vfc-huawei-vnfm-driver-8574569f4c-8jwc4 2/2 Running 1 2d
pod/vfc-vfc-juju-vnfm-driver-6dfd876bb8-bh7dq 2/2 Running 0 2d
pod/vfc-vfc-multivim-proxy-58c7bd47dc-7qdtd 1/1 Running 0 2d
pod/vfc-vfc-nokia-v2vnfm-driver-7b77c469bd-krfrw 1/1 Running 0 2d
pod/vfc-vfc-nokia-vnfm-driver-98fbdb5b5-p9zqw 2/2 Running 0 2d
pod/vfc-vfc-nslcm-74956bb876-v9kbt 2/2 Running 0 2d
pod/vfc-vfc-resmgr-57dc4c98b5-dzp7f 2/2 Running 0 2d
pod/vfc-vfc-vnflcm-6f9dc7df44-hncf4 2/2 Running 1 2d
pod/vfc-vfc-vnfmgr-5585c688c6-7qrnp 2/2 Running 0 2d
pod/vfc-vfc-vnfres-54bc985599-9zkqn 2/2 Running 0 2d
pod/vfc-vfc-workflow-6db56f95b9-np8tg 1/1 Running 1 2d
pod/vfc-vfc-workflow-engine-7fb49fd974-kcb8q 1/1 Running 1 2d
pod/vfc-vfc-zte-sdnc-driver-585d449797-87nhp 1/1 Running 0 2d
pod/vfc-vfc-zte-vnfm-driver-59d4756fbc-rpn9v 2/2 Running 0 2d
--omitted for simplicity
</code></pre>

<p>You can open the MSB portal <a href="http://Node_IP:30280/iui/microservices/default.html">http://Node_IP:30280/iui/microservices/default.html</a> in the browser to see all the registered services.
<img src="https://img.zhaohuabing.com/in-post/2018-08-01-manage-onap-with-istio/msb.png" alt="MSB Portal" /></p>

<h1 id="explore-istio-features">Explore Istio Features</h1>

<h2 id="distributed-tracing">Distributed Tracing</h2>

<p>First, let&rsquo;s generate some traffics in the application, access the following URLs with curl command or open them in the browser</p>

<ul>
<li><a href="http://node_ip:30280/api/multicloud/v0/swagger.json">http://node_ip:30280/api/multicloud/v0/swagger.json</a></li>
<li><a href="http://node_ip:30280/api/multicloud-vio/v0/swagger.json">http://node_ip:30280/api/multicloud-vio/v0/swagger.json</a></li>
<li><a href="http://node_ip:30280/api/multicloud-ocata/v0/swagger.json">http://node_ip:30280/api/multicloud-ocata/v0/swagger.json</a></li>
</ul>

<p>Then open your browser at <a href="http://tracing_node_ip:tracing_node_port/">http://tracing_node_ip:tracing_node_port/</a>, you should see something similar to the following:
<img src="https://img.zhaohuabing.com/in-post/2018-08-01-manage-onap-with-istio/tracing.png" alt="Distributed Tracing" /></p>

<p>Note:</p>

<ul>
<li>Tracing_node_port can be found by &lsquo;kubctl get svc -n istio-system&rsquo;.</li>
<li>ONAP microservices need to propagate the appropriate HTTP headers so that when the proxies send span information, the spans can be correlated correctly into a single trace.</li>
</ul>

<h2 id="service-graph">Service Graph</h2>

<p>Istio provides a Servicegraph service which generates and visualizes graph representations of the services in the mesh.</p>

<p>Open your browser at <a href="http://node_ip:30088/dotviz">http://node_ip:30088/dotviz</a> or <a href="http://node_ip:30088/force/forcegraph.html">http://node_ip:30088/force/forcegraph.html</a>, you should see the service graph:
<img src="https://img.zhaohuabing.com/in-post/2018-08-01-manage-onap-with-istio/servicegraph.png" alt="Service Graph" /></p>

<h2 id="metrics-visualization">Metrics Visualization</h2>

<p>Istio automatically gathers telemetry for services in a mesh. A Prometheus adapter is plugged into Mixer to serve the generated metric data. A Grafana addon is pre-configured with a Prometheus data source and has an Istio dashboard installed for the metric visualization.</p>

<p>Open your browser at <a href="http://node_ip:30300">http://node_ip:30300</a>, you should see the Grafana Istio dashboard:
<img src="https://img.zhaohuabing.com/in-post/2018-08-01-manage-onap-with-istio/metrics.png" alt="Metrics" /></p>

<p><em>What&rsquo;s the next? we will enable mutual TLS authentication and leverage Istio RBAC for ONAP microservices communication security. Comment here to leave your thoughts or join our <a href="https://wiki.onap.org/display/DW/MSB+Meeting+Notes">weekly project meeting</a> if you&rsquo;re interested.</em></p>

        
                
                    
<div class="entry-shang text-center">
    
	    <p>「真诚赞赏，手留余香」</p>
	
	<button class="zs show-zs btn btn-bred">赞赏支持</button>
</div>
<div class="zs-modal-bg"></div>
<div class="zs-modal-box">
	<div class="zs-modal-head">
		<button type="button" class="close">×</button>
		<span class="author"><a href="https://zhaohuabing.com"><img src="/img/favicon.png" />Huabing Blog</a></span>
        
	        <p class="tip"><i></i><span>真诚赞赏，手留余香</span></p>
		
 
	</div>
	<div class="zs-modal-body">
		<div class="zs-modal-btns">
			<button class="btn btn-blink" data-num="2">2元</button>
			<button class="btn btn-blink" data-num="5">5元</button>
			<button class="btn btn-blink" data-num="10">10元</button>
			<button class="btn btn-blink" data-num="50">50元</button>
			<button class="btn btn-blink" data-num="100">100元</button>
			<button class="btn btn-blink" data-num="1">任意金额</button>
		</div>
		<div class="zs-modal-pay">
			<button class="btn btn-bred" id="pay-text">2元</button>
			<p>使用<span id="pay-type">微信</span>扫描二维码完成支付</p>
			<img src="/img/reward/wechat-2.png"  id="pay-image"/>
		</div>
	</div>
	<div class="zs-modal-footer">
		<label><input type="radio" name="zs-type" value="wechat" class="zs-type" checked="checked"><span ><span class="zs-wechat"><img src="/img/reward/wechat-btn.png"/></span></label>
		<label><input type="radio" name="zs-type" value="alipay" class="zs-type" class="zs-alipay"><img src="/img/reward/alipay-btn.png"/></span></label>
	</div>
</div>
<script type="text/javascript" src="/js/reward.js"></script>

                
        
              <hr>
              <ul class="pager">
                  
                  <li class="previous">
                      <a href="/post/2018-08-15-manage-onap-with-istio-auth-enabled/" data-toggle="tooltip" data-placement="top" title="Secure ONAP Microservices with Istio Mutual TLS Authentication and RBAC">&larr; Previous Post</a>
                  </li>
                  
                  
                  <li class="next">
                      <a href="/post/2018-06-22-onap-with-service-mesh/" data-toggle="tooltip" data-placement="top" title="How service mesh can help during the ONAP Microservice journey">Next Post &rarr;</a>
                  </li>
                  
              </ul>
  
              
<div id="disqus-comment"></div>

<script src="/js/iDisqus.js"></script>
<script>
var disq = new iDisqus('disqus-comment', {
    forum: 'zhaohuabings-blog',
    api: 'https:\/\/disqusapi.zhaohuabing.com',
	site: 'https:\/\/zhaohuabing.com',
    mode: 1,
    timeout: 5000,
    init: true
});
</script>



            </div>
            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                        
                        
                        
                        <a href="/tags/bitcoin" title="Bitcoin">
                        Bitcoin
                        </a>
                        
                        
                        
                        <a href="/tags/blockchain" title="Blockchain">
                        Blockchain
                        </a>
                        
                        
                        
                        <a href="/tags/cryptocurrency" title="Cryptocurrency">
                        Cryptocurrency
                        </a>
                        
                        
                        
                        <a href="/tags/digital-signature" title="Digital Signature">
                        Digital Signature
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/envoy" title="Envoy">
                        Envoy
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/istio" title="Istio">
                        Istio
                        </a>
                        
                        
                        
                        <a href="/tags/kubernetes" title="Kubernetes">
                        Kubernetes
                        </a>
                        
                        
                        
                        <a href="/tags/microservice" title="Microservice">
                        Microservice
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/onap" title="ONAP">
                        ONAP
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/security" title="Security">
                        Security
                        </a>
                        
                        
                        
                        <a href="/tags/service-mesh" title="Service Mesh">
                        Service Mesh
                        </a>
                        
                        
                        
                        <a href="/tags/tips" title="Tips">
                        Tips
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                    </div>
                </section>
                

                
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                   <li>
                       <a href="" rel="alternate" type="application/rss+xml" title="Huabing Blog" >
                           <span class="fa-stack fa-lg">
                               <i class="fa fa-circle fa-stack-2x"></i>
                               <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                           </span>
                       </a>
                   </li>
                   
                    
                    <li>
                        <a href="mailto:zhaohuabing@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    

                    

		    
                    
                    <li>
                        <a target="_blank" href="/img/wechat_qrcode.jpg">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-wechat fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    <li>
                        <a target="_blank" href="https://github.com/zhaohuabing">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/zhaohuabing">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy; Huabing Blog , 2018
                    <br>
                    <a href="https://themes.gohugo.io/hugo-theme-cleanwhite">CleanWhite Hugo Theme</a> by <a href="https://zhaohuabing.com">Huabing</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https'){
       bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      }
      else{
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>




<script>
    
    var _baId = 'a1d96090e4189c0376251fb043da7be5';

    
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>




<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-109223766-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>



</body>
</html>
